---
title: "STAT 331 Final Portfolio"
author: "Kallan Torell"
format: html 
embed-resources: true
layout: margin-left
editor: visual
execute: 
  eval: false
  echo: false
---

[**My Grade:**]{.underline} I believe my grade equivalent to course work evidenced below to be an \_\_.

[**Learning Objective Evidence:**]{.underline} In the code chunks below, provide code from Lab or Challenge assignments where you believe you have demonstrated proficiency with the specified learning target. Be sure to specify **where** the code came from (e.g., Lab 4 Question 2).

## Working with Data

**WD-1: I can import data from a *variety* of formats (e.g., csv, xlsx, txt, etc.).**

-   `csv` Example 1

```{r}
#| label: wd-1-csv-1
#| label: Lab 4 Problem 0

#| label: load-data

childcare_costs <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv')

counties <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/counties.csv')

tax_rev <- read_csv('https://atheobold.github.io/groupworthy-data-science/labs/instructions/data/ca_tax_revenue.csv')

head(childcare_costs)
```

-   `csv` Example 2

```{r}
#| label: wd-1-csv-2
#| label: Lab 2 Problem 1

surveys <- read_csv("surveys.csv")
head(surveys)
glimpse(surveys)

```

-   `xlsx`

```{r}
#| label: wd-1-xlsx
#| label: Challenge 4: Childcare Prices Problem 0

my_data <- read_excel("C:/Users/Kallan/Downloads/NDCP2022.xlsx")

head(my_data)


```

**WD-2: I can select necessary columns from a dataset.**

-   Example selecting specified columns

```{r}
#| label: wd-2-ex-1
#| Lab 2 Problem 2

ca_childcare <- counties |>
  filter(state_abbreviation == "CA" | state_name == "California") |>
  select(state_name, state_abbreviation, county_name, county_fips_code) |>
  inner_join(
    childcare_costs |>
      mutate(county_fips = county_fips_code),
    by = "county_fips_code"
  )

glimpse(ca_childcare)

```

-   Example removing specified columns

```{r}
#| label: wd-2-ex-2
#| Lab 2 Problem 2

ca_childcare <- counties |>
  filter(state_abbreviation == "CA" | state_name == "California") |>
  select(state_name, state_abbreviation, county_name, county_fips_code) |>
  inner_join(
    childcare_costs |>
      mutate(county_fips = county_fips_code),
    by = "county_fips_code"
  )

glimpse(ca_childcare)

```

-   Example selecting columns based on logical values (e.g., `starts_with()`, `ends_with()`, `contains()`, `where()`)

```{r}
#| label: wd-2-ex-3

```

**WD-3: I can filter rows from a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-3-numeric-ex-1
#| lab 4 problem 6

lowest_price_2018 <- ca_childcare |>
  filter(study_year == 2018) |>
  group_by(census_region) |>
  summarise(median_infant_price = median(mc_infant, na.rm = TRUE)) |>
  slice_min(median_infant_price)

```

-   Numeric Example 2

```{r}
#| label: wd-3-numeric-ex-1
#| lab 5 problem gym investigation

checkins <- get_fit_now_check_in |>
  filter(check_in_date == "20180109") |>
  select(membership_id)
#https://dplyr.tidyverse.org/reference/select.html
#just needed syntax help and filtering help
gym_checkins <- members |>
  inner_join(checkins, by = c("id" = "membership_id")) |>
  select(person_id, name)

```

-   Character Example 1 (any context)

```{r}
#| label: wd-3-character
#| lab 4 problem 2
ca_childcare <- counties |>
  filter(state_abbreviation == "CA" | state_name == "California") |>
  select(state_name, state_abbreviation, county_name, county_fips_code) |>
  inner_join(
    childcare_costs |>
      mutate(county_fips = county_fips_code),
    by = "county_fips_code"
  )

```

-   Character Example 2 (example must use functions from **stringr**)

```{r}
#| label: wd-3-string
#| lab 4 problem final suspect

suspects <- gym_checkins |>
  left_join(person |> select(-name), by = c("person_id" = "id")) |>
  left_join(drivers_license, by = c("license_id" = "id")) |>
  transmute(person_id, name, plate_number, gender)
# https://dplyr.tidyverse.org/reference/transmute.html
# wanted help with the syntax on column management using transmute
final_suspect <- suspects |>
  filter(str_detect(plate_number, "H42W"), gender == "male")

```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-3-date
#| Lab 5 - Crime Scene Investigation
crime_scene_report |>
  mutate(date = ymd(date)) |>
  filter(
    date == ymd("2018-01-15"),
    month(date) == 1,
    year(date) == 2018
  )
#revised: originally, I changed all the dates to strings and parsed through them manually, however, after your comments I saw that lubridate would make it easier and this lab is the best example of using lubridate
```

**WD-4: I can modify existing variables and create new variables in a dataframe for a *variety* of data types (e.g., numeric, integer, character, factor, date).**

-   Numeric Example 1

```{r}
#| label: wd-4-numeric-ex-1
#| Challenge 7 Problem 1

fish <- fish |>
  mutate(length_cm = length / 10)
```

-   Numeric Example 2

```{r}
#| label: wd-4-numeric-ex-2
#| Lab 4 Problem 3

ca_childcare <- ca_childcare |> 
  mutate(county_name = str_remove(county_name, " County"))
```

-   Factor Example 1 (renaming levels)

```{r}
#| label: wd-4-factor-ex-1
#| Lab 4 Problem 7

dataplot <- ca_childcare |>
  mutate(
    age = recode(age,
                 mc_infant = "Infant",
                 mc_toddler = "Toddler",
                 mc_preschool = "Preschool"),
    age = factor(age, levels = c("Infant", "Toddler", "Preschool"))
  )
```

-   Factor Example 2 (reordering levels)

```{r}
#| label: wd-4-factor-ex-2
#| Lab 4 Problem 4
superior_counties <- c("Butte","Colusa","El Dorado",
                       "Glenn","Lassen","Modoc",
                       "Nevada","Placer","Plumas",
                       "Sacramento","Shasta","Sierra","Siskiyou",
                       "Sutter","Tehama","Yolo","Yuba")

north_coast_counties <- c("Del Norte","Humboldt","Lake",
                          "Mendocino","Napa","Sonoma","Trinity")

san_fran_counties <- c("Alameda","Contra Costa","Marin",
                       "San Francisco","San Mateo","Santa Clara",
                       "Solano")

n_san_joaquin_counties <- c("Alpine","Amador","Calaveras","Madera",
                            "Mariposa","Merced","Mono","San Joaquin",
                            "Stanislaus","Tuolumne")

central_coast_counties <- c("Monterey","San Benito","San Luis Obispo",
                            "Santa Barbara","Santa Cruz","Ventura")

s_san_joaquin_counties <- c("Fresno","Inyo","Kern","Kings","Tulare")

inland_counties <- c("Riverside","San Bernardino")

la_county <- "Los Angeles"

orange_county  <- "Orange"

san_diego_imperial_counties <- c("Imperial","San Diego")
```

-   Character (example must use functions from **stringr**)

```{r}
#| label: wd-4-string
#| Lab 7 Problem 2

dataplot <- dataplot |>
  mutate(variable = str_remove(variable, "^missing_"))
```

-   Date (example must use functions from **lubridate**)

```{r}
#| label: wd-4-date
#| Lab 5 - Check-in dates
get_fit_now_check_in |>
  mutate(
    check_in_date = ymd(check_in_date),
    check_in_month = month(check_in_date, label = TRUE),
    check_in_day = wday(check_in_date, label = TRUE),
    days_since = as.numeric(ymd("2018-01-15") - check_in_date)
  ) |>
  filter(check_in_date == ymd("2018-01-09"))

#revised: once again, i chose to filter through everything using strings and not lubridate(). lubridate() makes this much easer and better looking as you recommended in the portfolio meeting.
```

**WD-5: I can use mutating joins to combine multiple dataframes.**

-   `left_join()` Example 1

```{r}
#| label: wd-5-left-ex-1
#| lab 4 problem 3
ca_childcare <- counties |>
  filter(state_abbreviation == "CA") |>
  select(state_name, state_abbreviation, county_name, county_fips_code) |>
  inner_join(childcare_costs, by = "county_fips_code") |>
  left_join(
    tax_rev |>
      rename(county_name = entity_name) |>
      select(county_name, year, total_property_taxes, sales_and_use_taxes),
    by = c("county_name" = "county_name", "study_year" = "year")
  )
```

-   `right_join()` Example 1

```{r}
#| label: wd-5-right
#| lab 5 problem gym investigation
suspects <- person |> 
  select(-name) |>
  right_join(gym_checkins, by = c("id" = "person_id")) |>
  right_join(drivers_license, by = c("license_id" = "id")) |>
  transmute(person_id = id.x, name, plate_number, gender)

final_suspect <- suspects |>
  filter(str_detect(plate_number, "H42W"), gender == "male")

final_suspect
#revised: originally did left joins but I tend to use those too much so made a right join alternative
```

-   `left_join()` **or** `right_join()` Example 2

```{r}
#| label: wd-5-left-right-ex-2
#| lab 5 problem gym investigation
suspects <- gym_checkins |>
  left_join(person |> select(-name), by = c("person_id" = "id")) |>
  left_join(drivers_license, by = c("license_id" = "id")) |>
  transmute(person_id, name, plate_number, gender)
# https://dplyr.tidyverse.org/reference/transmute.html
# wanted help with the syntax on column management using transmute
final_suspect <- suspects |>
  filter(str_detect(plate_number, "H42W"), gender == "male")

final_suspect
```

-   `inner_join()` Example 1

```{r}
#| label: wd-5-inner-ex-1
#| lab 4 problem 3
ca_childcare <- counties |>
  filter(state_abbreviation == "CA") |>
  select(state_name, state_abbreviation, county_name, county_fips_code) |>
  inner_join(childcare_costs, by = "county_fips_code") |>
  left_join(
    tax_rev |>
      rename(county_name = entity_name) |>
      select(county_name, year, total_property_taxes, sales_and_use_taxes),
    by = c("county_name" = "county_name", "study_year" = "year")
  )
```

-   `inner_join()` Example 2

```{r}
#| label: wd-5-inner-ex-2
#| lab 5 problem gym investigation
checkins <- get_fit_now_check_in |>
  filter(check_in_date == "20180109") |>
  select(membership_id)
gym_checkins <- members |>
  inner_join(checkins, by = c("id" = "membership_id")) |>
  select(person_id, name)

gym_checkins

```

**WD-6: I can use filtering joins to filter rows from a dataframe.**

-   `semi_join()`

```{r}
#| label: wd-6-semi
#| Lab 3 question 10
high_rated_teachers <- clean_teacher_evals |>
  filter(question_no == 901, SET_score_avg >= 4.5) |>
  distinct(teacher_id)


all_data_for_high_teachers <- clean_teacher_evals |>
  semi_join(high_rated_teachers, by = "teacher_id")
#revised: this question is a great time to use a semi_join, and extend the question. After cleaning, someone might want to find all or any records for teachers who have at least one highly rated course.
```

-   `anti_join()`

```{r}
#| label: wd-6-anti
#| Lab 3 question 5
original_data <- teacher_evals


kept_data <- teacher_evals |>
  filter(no_participants >= 10)


excluded_data <- original_data |>
  anti_join(kept_data, by = c("course_id", "teacher_id", "question_no"))
#Revised/Extended thinking: good moment to use an anti_join to understand what data was excluded during cleaning
```

**WD-7: I can pivot dataframes from long to wide and visa versa**

-   `pivot_longer()`

```{r}
#| label: wd-7-long
#| lab 4 problem 7
dataplot <- ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |>
  pivot_longer(mc_infant:mc_preschool, names_to = "age", values_to = "price") |>
  mutate(
    age = recode(age,
                 mc_infant = "Infant",
                 mc_toddler = "Toddler",
                 mc_preschool = "Preschool"),
    age = factor(age, levels = c("Infant", "Toddler", "Preschool"))
  )
```

-   `pivot_wider()`

```{r}
#| label: wd-7-wide
#| Lab 7 Problem 2

fish |>
  summarize(across(everything(), ~ sum(is.na(.)), .names = "missing_{col}")) |>
  pivot_longer(everything(), names_to = "variable", values_to = "count") |>
  mutate(variable = str_remove(variable, "^missing_")) |>
  pivot_wider(
    names_from = variable,
    values_from = count,
    values_fill = 0,
    names_prefix = "missing_"
  )
```

## Reproducibility

**R-1: I can create professional looking, reproducible analyses using RStudio projects, Quarto documents, and the here package.**

The following assignments satisfy the above criteria:

-   Example 1 – Lab 1, Question 2: Practicing running code with built-in data

    Example 2 – Lab 2, Question 1: Loading surveys.csv with readr

    Example 3 – Challenge 2, setup: Reusing Lab 2’s reproducible setup

    Example 4 – Lab 3, Questions 1–2: Using here() to load teacher_evals

    Example 5 – Lab 7, setup: Loading and inspecting BlackfootFish.csv

**R-2: I can write well documented and tidy code.**

-   Example of **ggplot2** plotting

```{r}
#| label: r-2-1
#| lab 2 problem 4

ggplot(data = surveys, 
       mapping = aes(x = hindfoot_length, y = weight)) +
  geom_point(alpha = 0.5) +
  facet_wrap(~ species) +
  labs(
    x = "Hindfoot Length (mm)",
    y = "",
    title = "Scatterplot of Weight vs Hindfoot Length by Species",
    subtitle = "Weight (g) on y-axis"
  ) 

```

-   Example of **dplyr** pipeline

```{r}
#| label: r-2-2
#| lab 4 problem 6

lowest_price_2018 <- ca_childcare |>
  filter(study_year == 2018) |>
  group_by(census_region) |>
  summarise(median_infant_price = median(mc_infant, na.rm = TRUE)) |>
  slice_min(median_infant_price)


```

-   Example of function formatting

```{r}
#| label: r-2-3
#| Lab 7 Problem 4

rescale_01 <- function(x, na.rm = TRUE) {
  if (!is.numeric(x)) stop("`x` must be numeric.")
  if (length(x) <= 1) stop("`x` must have length > 1.")
  
  if (all(is.na(x))) return(x)
  r <- range(x, na.rm = na.rm)
  rng <- r[2] - r[1]
  if (rng == 0) return(ifelse(is.na(x), NA_real_, 0))
  (x - r[1]) / rng
}
```

**R-3: I can write robust programs that are resistant to changes in inputs.**

-   Example (any context)

```{r}
#| label: r-3-example
#| Lab 7 Problem 4

rescale_01 <- function(x, na.rm = TRUE) {
  if (all(is.na(x))) return(x)  # Handles all NA case
  r <- range(x, na.rm = na.rm)
  rng <- r[2] - r[1]
  if (rng == 0) return(ifelse(is.na(x), NA_real_, 0))  # Handles zero range case
  (x - r[1]) / rng
}
```

-   Example (function stops)

```{r}
#| label: r-3-function-stops
#| Lab 8 Problem 1

rescale_column <- function(df, cols) {
  df |>
    dplyr::mutate(
      dplyr::across({{ cols }}, rescale_01)
    )
}
```

## Data Visualization & Summarization

**DVS-1: I can create visualizations for a *variety* of variable types (e.g., numeric, character, factor, date)**

-   At least two numeric variables

```{r}
#| label: dvs-1-num
#| Lab 2 problem 4

ggplot(data = surveys, 
       mapping = aes(x = hindfoot_length, y = weight)) +
  geom_point(alpha = 0.5) +
  facet_wrap(~ species) +
  labs(
    x = "Hindfoot Length (mm)",
    y = "",
    title = "Scatterplot of Weight vs Hindfoot Length by Species",
    subtitle = "Weight (g) on y-axis"
  ) 

```

-   At least one numeric variable and one categorical variable

```{r}
#| label: dvs-2-num-cat
#| lab 2 problem 10

ggplot(data = surveys, aes(x = species, y = weight)) +
  geom_boxplot(alpha = 0.5) +
  labs(
    x = "Species",
    y = "Weight (g)",
    title = "Distribution of Weight by Species"
  ) + 
  geom_jitter(color = 'burlywood4') + 
  theme(axis.text.x = element_text(angle = 45))

```

-   At least two categorical variables

```{r}
#| label: dvs-2-cat
#| lab 4 problem 7

dataplot <- ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |>
  pivot_longer(mc_infant:mc_preschool, names_to = "age", values_to = "price") |>
  mutate(
    age = recode(age,
                 mc_infant = "Infant",
                 mc_toddler = "Toddler",
                 mc_preschool = "Preschool"),
    age = factor(age, levels = c("Infant", "Toddler", "Preschool"))
  )

ggplot(dataplot, aes(study_year, price, color = census_region)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "loess", se = FALSE) +
  facet_wrap(~ age, nrow = 1) +
  scale_x_continuous(breaks = seq(2008, 2018, 2)) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "Median Weekly Price ($)",
    color = "California Region"
  )

```

-   Dates (time series plot)

```{r}
#| label: dvs-2-date
#| lab 4 problem 8

ggplot(ca_childcare, aes(x = mhi_2018, y = mc_infant)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(
    title = "Income vs. Infant Center-Based Weekly Price (CA)",
    x = "Median household income (2018 Dollars)",
    y = "Median weekly price (Dollars)"
  )


```

**DVS-2: I use plot modifications to make my visualization clear to the reader.**

-   I can modify my plot theme to be more readable

```{r}
#| label: dvs-2-ex-1
#| Lab 8: plot-function chunk

boxplot_plot <- function(df, x, y, fill_var, title = NULL) {
  if (missing(fill_var)) {
    plot_q3 <- df |>
      ggplot2::ggplot(ggplot2::aes(x = {{ x }}, y = {{ y }}, fill = {{ x }})) +
      ggplot2::geom_boxplot() +
      ggplot2::theme_light() +
      ggplot2::guides(fill = "none")
  } else {
    plot_q3 <- df |>
      ggplot2::ggplot(ggplot2::aes(x = {{ x }}, y = {{ y }}, fill = {{ fill_var }})) +
      ggplot2::geom_boxplot() +
      ggplot2::theme_light()
  }

  if (!is.null(title)) plot_q3 <- plot_q3 + ggplot2::labs(title = title)
  plot_q3
}

```

-   I can modify my colors to be accessible to anyone's eyes

```{r}
#| label: dvs-2-ex-2
#| lab 4 problem 7

dataplot <- ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |>
  pivot_longer(mc_infant:mc_preschool, names_to = "age", values_to = "price") |>
  mutate(
    age = recode(age,
                 mc_infant = "Infant",
                 mc_toddler = "Toddler",
                 mc_preschool = "Preschool"),
    age = factor(age, levels = c("Infant", "Toddler", "Preschool"))
  )

ggplot(dataplot, aes(study_year, price, color = census_region)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "loess", se = FALSE) +
  facet_wrap(~ age, nrow = 1) +
  scale_x_continuous(breaks = seq(2008, 2018, 2)) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "Median Weekly Price ($)",
    color = "California Region"
  )

```

-   I can modify my plot titles to clearly communicate the data context

```{r}
#| label: dvs-2-ex-3
#| lab 2 problem 4

ggplot(data = surveys, 
       mapping = aes(x = hindfoot_length, y = weight)) +
  geom_point(alpha = 0.5) +
  facet_wrap(~ species) +
  labs(
    x = "Hindfoot Length (mm)",
    y = "",
    title = "Scatterplot of Weight vs Hindfoot Length by Species",
    subtitle = "Weight (g) on y-axis"
  ) 
#Revision: removed angle text argument, fixed "head tilt" explained by instructor when reading an axis label
```

-   I can modify the text in my plot to be more readable

```{r}
#| label: dvs-2-ex-4
#| lab 2 problem 16

ggplot(data = surveys, aes(x = weight, y = species)) +
  geom_boxplot(alpha = 0.5) +
  labs(
    x = "Species",
    y = "Weight (g)",
    title = "Distribution of Weight by Species"
  ) + 
  geom_jitter(color = 'steelblue') 
  #(revised:removed angle argument)
```

-   I can reorder my legend to align with the colors in my plot

```{r}
#| label: dvs-2-ex-5
#| style-plot-test-2 Revised
penguins_releveled <- penguins |>
  dplyr::mutate(sex = forcats::fct_relevel(sex, "female", "male"))

boxplot_plot(penguins_releveled, species, body_mass_g, fill_var = sex, 
             title = "Body Mass by Species and Sex") |>
  style_plot(theme_fn = theme_light,
             palette_fn = function(n) viridisLite::mako(n),
             aesthetic = "fill")
#Revision: through independent research and instructor noting my lack of legend ordering, I revised the above plot i made and created a releveled version using https://www.rdocumentation.org/packages/forcats/versions/1.0.1/topics/fct_relevel
# uses forcats package and manually reorders the levels of a factor variable
# releveling sex makes the legend order more intentional
```

**DVS-3: I show creativity in my visualizations**

-   I can use non-standard colors (Example 1)

```{r}
#| label: dvs-3-1-ex-1
#| lab 2 problem 3

ggplot(data = surveys,
       mapping = aes(x = weight, y = hindfoot_length)) +
  geom_point(color = 'cadetblue')

```

-   I can use non-standard colors (Example 2)

```{r}
#| label: dvs-3-1-ex-2
#| lab 2 problem 10

ggplot(data = surveys, aes(x = species, y = weight)) +
  geom_boxplot(alpha = 0.5) +
  labs(
    x = "Species",
    y = "Weight (g)",
    title = "Distribution of Weight by Species"
  ) + 
  geom_jitter(color = 'burlywood4') + 
  theme(axis.text.x = element_text(angle = 45))

```

-   I can use annotations (e.g., `geom_text()`)

```{r}
#| label: dvs-3-2
#| Lab 8: style-plot-test-1
library(RColorBrewer)

penguin_counts <- penguins |>
  count(species, sex)

ggplot(penguin_counts, aes(x = species, y = n, fill = sex)) +
  geom_col(position = "dodge") +
  geom_text(
    aes(label = n),
    position = position_dodge(width = 0.85),
    vjust = -0.3,
    size = 3
  ) +
  labs(
    title = "Penguin counts by species and sex",
    x = "Species",
    y = "Count"
  )
#revised: added gemo_text and geom_col to add to aesthetic of plot
```

-   I can choose creative geometries (e.g., `geom_segment()`, `geom_ribbon)()`)

```{r}
#| label: dvs-3-3
#| lab 4 problem 7
ggplot(dataplot, aes(study_year, price, color = census_region)) +
  geom_point(alpha = 0.7) +
  geom_smooth(method = "loess", se = FALSE) +
  facet_wrap(~ age, nrow = 1) +
  scale_x_continuous(breaks = seq(2008, 2018, 2)) +
  labs(
    title = "Weekly Median Price for Center-Based Childcare ($)",
    x = "Study Year", y = "Median Weekly Price ($)",
    color = "California Region"
  )
```

**DVS-4: I can calculate numerical summaries of variables.**

-   Example using `summarize()`

```{r}
#| label: dvs-4-summarize
#| lab 4 problem 6

lowest_price_2018 <- ca_childcare |>
  filter(study_year == 2018) |>
  group_by(census_region) |>
  summarise(median_infant_price = median(mc_infant, na.rm = TRUE)) |>
  slice_min(median_infant_price)

```

-   Example using `across()`

```{r}
#| label: dvs-4-across
#| Lab 7 Problem 1

fish |>
  summarize(
    across(
      .cols  = everything(),
      .fns   = ~ sum(is.na(.)),
      .names = "missing_{col}"
    )
  )
```

**DVS-5: I can find summaries of variables across multiple groups.**

-   Example 1

```{r}
#| label: dvs-5-1
#| Lab 3 Problem 10

clean_teacher_evals |>
  filter(question_no == 901) |>
  group_by(teacher_id) |>
  summarize(
    n_courses = n_distinct(course_id),
    avg_q1 = mean(SET_score_avg, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(n_courses >= 5)
```

-   Example 2

```{r}
#| label: dvs-5-2
#| Lab 4 Problem 5

ca_childcare |>
  group_by(census_region) |>
  summarise(
    `2008` = median(mhi_2018[study_year == 2008], na.rm = TRUE),
    `2018` = median(mhi_2018[study_year == 2018], na.rm = TRUE)
  ) |>
  arrange(desc(`2018`))
```

**DVS-6: I can create tables which make my summaries clear to the reader.**

-   I can modify my column names to clearly communicate the data context

```{r}
#| label: dvs-6-ex-1
#| Lab 7: pivot-summary-table

fish |>
  summarize(
    across(
      .cols  = everything(),
      .fns   = ~ sum(is.na(.)),
      .names = "missing_{col}"
    )
  ) |>
  pivot_longer(
    cols      = everything(),
    names_to  = "variable",
    values_to = "count"
  ) |>
  mutate(variable = str_remove(variable, "^missing_")) |>
  pivot_wider(
    names_from   = variable,
    values_from  = count,
    values_fill  = 0,
    names_prefix = "missing_"
  )
```

-   I can modify the text in my table to be more readable (e.g., bold face for column headers)

```{r}
#| label: dvs-6-ex-2

```

-   I can arrange my table to have an intuitive ordering

```{r}
#| label: dvs-6-ex-3
#| Lab 4 Problem 5

median_income_by_region <- ca_childcare |>
  group_by(census_region) |>
  summarise(
    `2008` = median(mhi_2018[study_year == 2008], na.rm = TRUE),
    `2018` = median(mhi_2018[study_year == 2018], na.rm = TRUE)
  ) |>
  arrange(desc(`2018`))
#Thoughts: arrange is an intuitive ordering strategy for a date based table
```

**DVS-7: I show creativity in my tables.**

-   I can use non-default colors

```{r}
#| label: dvs-7-ex-1

```

-   I can modify the layout of my table to be more readable (e.g., `pivot_longer()` or `pivot_wider()`)

```{r}
#| label: dvs-7-ex-2
#| Lab 4 Problem 5

ca_childcare |>
  group_by(census_region) |>
  summarise(
    `2008` = median(mhi_2018[study_year == 2008], na.rm = TRUE),
    `2018` = median(mhi_2018[study_year == 2018], na.rm = TRUE)
  )
```

## Program Efficiency

**PE-1: I can write concise code which does not repeat itself.**

-   using a single function call with multiple inputs (rather than multiple function calls)

```{r}
#| label: pe-1-one-call
#| Lab 8 Problem 1

rescale_column(penguins, 
               cols = c(bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g))
```

-   using `across()`

```{r}
#| label: pe-1-across

```

-   using functions from the `map()` family

```{r}
#| label: pe-1-map-1

```

**PE-2: I can write functions to reduce repetition in my code.**

-   Example 1: Function that operates on vectors

```{r}
#| label: pe-2-1
#| Challenge 7 Problem 2

flag_outside_na <- function(x, min_val, max_val) {
  if (!is.numeric(x)) stop("`x` must be numeric.")
  if (length(x) == 0) return(x)
  x[!between(x, min_val, max_val) & !is.na(x)]
}
```

-   Example 2: Function that operates on data frames

```{r}
#| label: pe-2-2
#| Lab 8 Problem 2

pivot_table <- function(df, row_var, col_var) {
  df |>
    dplyr::count({{ row_var }}, {{ col_var }}) |>
    tidyr::pivot_wider(
      names_from = {{ col_var }},
      values_from = n,
      values_fill = 0
    ) |>
    janitor::adorn_totals(where = c("row", "col"))
}
```

-   Example 3: Function that operates on vectors *or* data frames

```{r}
#| label: pe-2-3
#| Lab 8 Problem 1

rescale_column <- function(df, cols) {
  df |>
    dplyr::mutate(
      dplyr::across({{ cols }}, rescale_01)
    )
}
```

**PE-3:I can use iteration to reduce repetition in my code.**

-   using `across()`

```{r}
#| label: pe-3-across

```

-   using a `map()` function with **one** input (e.g., `map()`, `map_chr()`, `map_dbl()`, etc.)

```{r}
#| label: pe-3-map-1

```

-   using a `map()` function with **more than one** input (e.g., `map_2()` or `pmap()`)

```{r}
#| label: pe-3-map-2

```

**PE-4: I can use modern tools when carrying out my analysis.**

-   I can use functions which are not superseded or deprecated

```{r}
#| label: pe-4-1
#| Lab 4 Problem 5

ca_childcare |>
  group_by(census_region) |>
  summarise(median_price = median(mc_infant, na.rm = TRUE))
#uses summarise() and not something like summarise_at() which is deprecated
```

-   I can connect a data wrangling pipeline into a `ggplot()`

```{r}
#| label: pe-4-2
#| Lab 4 Problem 7

ca_childcare |>
  select(census_region, study_year, mc_infant, mc_toddler, mc_preschool) |>
  pivot_longer(mc_infant:mc_preschool, names_to = "age", values_to = "price") |>
  mutate(age = recode(age, mc_infant = "Infant", mc_toddler = "Toddler", mc_preschool = "Preschool")) |>
  ggplot(aes(study_year, price, color = census_region)) +
  geom_point()
```

## Data Simulation & Statisical Models

**DSSM-1: I can simulate data from a *variety* of probability models.**

-   Example 1

```{r}
#| label: dsm-1-1

```

-   Example 2

```{r}
#| label: dsm-1-2

```

**DSSM-2: I can conduct common statistical analyses in R.**

-   Example 1

```{r}
#| label: dsm-2-1
#| Lab 1

t.test(len ~ supp, data = ToothGrowth,
       var.equal = FALSE, 
       alternative = "two.sided")
```

-   Example 2

```{r}
#| label: dsm-2-2
#| Lab 2 Problem 17

species_mod <- aov(weight ~ species, data = surveys)
summary(species_mod)
```

-   Example 3

```{r}
#| label: dsm-2-3
#| Lab 4 Problem 9

reg_mod1 <- lm(mc_infant ~ mhi_2018, data = ca_childcare)
summary(reg_mod1)
```

## Revising My Thinking

<!-- How did you revise your thinking throughout the course? How did you revise your thinking on the code examples you have provided in your portfolio? -->

Throughout finding examples in my code, I realized there are certain categories that I seem to skip over or not utilize as much. Whether it be certain types of joins, not making plots with ggplot using only categorical variables, or just clustered functions, I need to diversify my coding approaches in the second half of the quarter.

In the second half of the quarter, using the instructors notes and my own research I have been able to revise many parts of my thinking and my code. A great example of that was going back and looking at my Lab 5 original submission. The lab focuses on a database that has numerous time-based columns, which should immediately be an indicator to use lubridate for R, however, I changed all the dates to strings and manually filtered through them as if they were strings. As noted in the midterm meeting, I went back and looked for examples of changing my code to include lubridate, especially at the beginning where we were instructed to inspect crime-reports on specific dates to find witnesses to start off the investigation. Another example of revised thinking was using semi_join() and anti_join(). As I noted before, I very much leaned towards specific joins when I approached problems throughout the quarter, and took "direct" approaches when accessing columns. I used inner_join() frequently and distinguished my x and y ahead of time to directly include the data I wanted, when there are many times I could use a different approach to exclude unwanted data instead of taking the direct approach, which I displayed in Lab 3 through a couple revised thinking approaches.

<!-- For the revisions included in your Portfolio, to help me understand the nature of your revisions, please denote somehow the feedback I provided you (e.g., boldface, italics, colored text) before your revisions. -->

## Extending My Thinking

<!-- How did you extended your thinking throughout the course? How did you extend your thinking on the code examples you have provided in your portfolio? -->

At the start of this course, I approached all problems the same way I would a python data analytics problem. I realized quickly that I cannot approach R and Python in the same way, and needed to learn how to approach problems in R studio in a different way, which will help me expand this course. Many of the problems in the portfolio so far I have approached as python problems, and to diversify my thinking more, i need to learn to approach R separately.

## Peer Support & Collaboration

<!-- Include an image or a description of feedback you gave that you are proud of (either in a peer review or in Discord). -->

<!-- Include a description of how you grew as a collaborator through the weekly pair programming activities.   -->

As a peer collaborator, I struggled in the first few PA's because I did not allow my collaborators to think through problems themselves. I often jumped in too fast to help or filled in code segments for them without discussing it. However, after a few weeks, I felt much more at ease trusting my collaborating partners, and was able to sit back and let them think when they were the coder, which I believe helped them to allow me to think through things myself and grow as a coder as well.
